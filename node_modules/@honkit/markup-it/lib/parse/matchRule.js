"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const is_1 = __importDefault(require("is"));
const immutable_1 = __importDefault(require("immutable"));
const token_1 = __importDefault(require("../models/token"));
/**
 * Match a text using a rule
 * @param {ParsingState} state
 * @param {Rule} rule
 * @param {String} text
 * @return {List<Token>|null}
 */
function matchRule(state, rule, text) {
    let matches = rule.onText(state, text);
    const ruleType = rule.getType();
    if (!matches) {
        return;
    }
    if (!is_1.default.array(matches) && !immutable_1.default.List.isList(matches)) {
        matches = [matches];
    }
    return immutable_1.default.List(matches).map((match) => {
        // @ts-ignore
        return token_1.default.create(match.type || ruleType, match);
    });
}
exports.default = matchRule;
